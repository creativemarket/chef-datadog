<%= JSON.parse(({'logs' => @logs }).to_json).to_yaml %>

init_config:

instances:
<% @instances.each do |i| -%>
  - dbm: <%= i['dbm'] %>
    host: <%= i['host'] %>
  <% if i.key?('port') -%>
    port: <%= i['port'] %>
  <% end -%>
    username: <%= i['username'] %>
    password: <%= i['password'] %>
  <% if i.key?('sock') -%>
    sock: <%= i['sock'] %>
  <% end -%>
  <% if i.key?('min_collection_interval') -%>
    min_collection_interval: <%= i['min_collection_interval'] %>
  <% end -%>
  <% if i.key?('tags') -%>
    tags:
    <% i['tags'].each do |t| -%>
    - <%= t %>
    <% end -%>
  <% end -%>
  <% if i.key?('options') -%>
    options:
    <% i['options'].each do |o| -%>
      <%= o %>
    <% end -%>
  <% end -%>
  <% if i.key?('queries') -%>
    queries:
    <% i['queries'].each do |q| -%>
      - type: <%= q['type'] %>
        field: <%= q['field'] %>
        metric: <%= q['metric'] %>
        query: <%= q['query'] %>
    <% end -%>
  <% end -%>
<% end -%>
